import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.*;
import java.util.*;

public class PdfFinderToExcel {

    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);
        System.out.print("Enter folder path: ");
        String folderPath = scanner.nextLine().trim();

        File mainFolder = new File(folderPath);
        if (!mainFolder.exists() || !mainFolder.isDirectory()) {
            System.out.println("Invalid folder path.");
            return;
        }

        List<String[]> excelData = new ArrayList<>();
        File[] subfolders = mainFolder.listFiles(File::isDirectory);

        if (subfolders != null) {
            for (File subfolder : subfolders) {
                File[] pdfFiles = subfolder.listFiles((dir, name) -> name.toLowerCase().endsWith(".pdf"));
                String testPdfPath = "", sandboxPdfPath = "";

                if (pdfFiles != null) {
                    for (File pdf : pdfFiles) {
                        String fileName = pdf.getName().toLowerCase();
                        if (fileName.contains("test_mno")) {
                            testPdfPath = pdf.getAbsolutePath();
                        } else if (fileName.contains("sandbox_xyz")) {
                            sandboxPdfPath = pdf.getAbsolutePath();
                        }
                    }
                }

                if (!testPdfPath.isEmpty() || !sandboxPdfPath.isEmpty()) {
                    excelData.add(new String[]{
                        subfolder.getName(),
                        testPdfPath,
                        sandboxPdfPath,
                        "", // Range 1 placeholder
                        "", // Range 2 placeholder
                        ""  // Command placeholder
                    });
                }
            }
        }

        // Write to Excel
        String excelFilePath = folderPath + File.separator + "pdf_summary.xlsx";
        writeToExcel(excelData, excelFilePath);
        System.out.println("Excel written to: " + excelFilePath);
    }

    private static void writeToExcel(List<String[]> data, String filePath) throws IOException {
        Workbook workbook = new XSSFWorkbook();
        Sheet sheet = workbook.createSheet("PDF Report");

        // Static header row
        Row header = sheet.createRow(0);
        String[] headers = {"Item Name", "Path 1", "Path 2", "Range 1", "Range 2", "Command"};
        for (int i = 0; i < headers.length; i++) {
            header.createCell(i).setCellValue(headers[i]);
        }

        // Data rows from row 2 onward
        int rowNum = 1;
        for (String[] rowData : data) {
            Row row = sheet.createRow(rowNum++);
            for (int i = 0; i < rowData.length; i++) {
                row.createCell(i).setCellValue(rowData[i]);
            }
        }

        // Auto-size columns
        for (int i = 0; i < headers.length; i++) {
            sheet.autoSizeColumn(i);
        }

        // Save the file
        try (FileOutputStream out = new FileOutputStream(filePath)) {
            workbook.write(out);
        }
        workbook.close();
    }
}
